const ccTLD = [["ac", "어센션 섬"], ["ad", "안도라"], ["ae", "아랍에미리트"], ["af", "아프가니스탄"], ["ag", "앤티가 바부다"], ["ai", "앵귈라"], ["al", "알바니아"], ["am", "아르메니아"], ["an", "네덜란드령 안틸레스"], ["ao", "앙골라"], ["aq", "남극"], ["ar", "아르헨티나"], ["as", "미국령 사모아"], ["at", "오스트리아"], ["au", "오스트레일리아(호주)"], ["aw", "아루바"], ["ax", "올란드 제도"], ["az", "아제르바이잔"],
               ["ba", "보스니아 헤르체고비나"], ["bb", "바베이도스"], ["bd", "방글라데시"], ["be", "벨기에"], ["bf", "부르키나파소"], ["bg", "불가리아"], ["bh", "바레인"], ["bi", "부룬디"], ["bj", "베냉"], ["bm", "버뮤다"], ["bn", "브루나이"], ["bo", "볼리비아"], ["br", "브라질"], ["bs", "바하마"], ["bt", "부탄"], ["bv", "부베 섬[노르웨이]"], ["bw", "보츠와나"], ["by", "벨라루스"], ["bz", "벨리즈"], 
               ["ca", "캐나다"], ["cc", "코코스 제도"], ["cd", "콩고민주공화국"], ["cf", "중앙아프리카공화국"], ["cg", "콩고 공화국"], ["ch", "스위스"], ["ci", "코트디부아르"], ["ck", "쿡 제도"], ["cl", "칠레"], ["cm", "카메룬"], ["cn", "중국"], ["co", "콜롬비아"], ["cr", "코스타리카"], ["cs", "체코슬로바키아"], ["cu", "쿠바"], ["cv", "카보베르데"], ["cw", "퀴라소"], ["cx", "크리스마스 섬"], ["cy", "키프로스"], ["cz", "체코"],
               ["de", "독일"], ["dj", "지부티"], ["dk", "덴마크"], ["dm", "도미니카 연방"], ["do", "도미니카 공화국"], ["dz", "알제리"], 
               ["ec", "에콰도르"], ["ee", "에스토니아"], ["eg", "이집트"], ["er", "에리트레아"], ["es", "에스파냐"], ["et", "에티오피아"], ["eu", "유럽연합"], 
               ["fi", "핀란드"], ["fj", "피지"], ["fk", "포클랜드 제도"], ["fm", "미크로네시아 연방"], ["fo", "페로 제도"], ["fr", "프랑스"], 
               ["ga", "가봉"], ["gb", "영국"], ["gd", "그레나다"], ["ge", "조지아"], ["gf", "프랑스령 기아나"], ["gg", "건지 행정관 관할구"], ["gh", "가나"], ["gi", "지브롤터"], ["gl", "그린란드"], ["gm", "감비아"], ["gn", "기니"], ["gp", "과들루프"], ["gq", "적도 기니"], ["gr", "그리스"], ["gs", "사우스조지아 사우스샌드위치 제도"], ["gt", "과테말라"], ["gu", "괌"], ["gw", "기니비사우"], ["gy", "가이아나"], 
               ["hk", "홍콩"], ["hm", "허드 맥도널드 제도"], ["hn", "온두라스"], ["hr", "크로아티아"], ["ht", "아이티"], ["hu", "헝가리"], 
               ["id", "인도네시아"], ["ie", "아일랜드"], ["il", "이스라엘"], ["im", "맨 섬"], ["in", "인도"], ["io", "영국령 인도양 지역"], ["iq", "이라크"], ["ir", "이란"], ["is", "아이슬란드"], ["it", "이탈리아"], 
               ["je", "저지 행정관 관할구"], ["jm", "자메이카"], ["jo", "요르단"], ["jp", "일본"], ["ke", "케냐"], ["kg", "키르기스스탄"], ["kh", "캄보디아"], ["ki", "키리바시"], ["km", "코모로"], ["kn", "세인트 키츠 네비스"], ["kp", "북한"], ["kr", "대한민국"], ["kw", "쿠웨이트"], ["ky", "케이맨 제도"], ["kz", "카자흐스탄"], 
               ["la", "라오스"], ["lb", "레바논"], ["lc", "세인트 루시아"], ["li", "리히텐슈타인"], ["lk", "스리랑카"], ["lr", "라이베리아"], ["ls", "레소토"], ["lt", "리투아니아"], ["lu", "룩셈부르크"], ["lv", "라트비아"], ["ly", "리비아"], 
               ["ma", "모로코"], ["mc", "모나코"], ["md", "몰도바"], ["me", "몬테네그로"], ["mg", "마다가스카르"], ["mh", "마셜 제도"], ["mk", "북마케도니아"], ["ml", "말리"], ["mm", "미얀마"], ["mn", "몽골"], ["mo", "마카오"], ["mp", "북마리아나 제도"], ["mq", "마르티니크"], ["mr", "모리타니"], ["ms", "몬트세랫"], ["mt", "몰타"], ["mu", "모리셔스"], ["mv", "몰디브"], ["mw", "말라위"], ["mx", "멕시코"], ["my", "말레이시아"], ["mz", "모잠비크"], 
               ["na", "나미비아"], ["nc", "누벨칼레도니"], ["ne", "니제르"], ["nf", "노퍽 섬"], ["ng", "나이지리아"], ["ni", "니카라과"], ["nl", "네덜란드"], ["no", "노르웨이"], ["np", "네팔"], ["nr", "나우루"], ["nu", "니우에"], ["nz", "뉴질랜드"], 
               ["om", "오만"], 
               ["pa", "파나마"], ["pe", "페루"], ["pf", "프랑스령 폴리네시아"], ["pg", "파푸아뉴기니"], ["ph", "필리핀"], ["pk", "파키스탄"], ["pl", "폴란드"], ["pm", "생피에르 미클롱"], ["pn", "핏케언 제도"], ["pr", "푸에르토리코"], ["ps", "팔레스타인"], ["pt", "포르투갈"], ["pw", "팔라우"], ["py", "파라과이"], 
               ["qa", "카타르"], 
               ["re", "레위니옹"], ["ro", "루마니아"], ["rs", "세르비아"], ["ru", "러시아"], ["rw", "르완다"], 
               ["sa", "사우디아라비아"], ["sb", "솔로몬 제도"], ["sc", "세이셸"], ["sd", "수단"], ["se", "스웨덴"], ["sg", "싱가포르"], ["sh", "세인트헬레나 어센션 트리스탄다쿠냐"], ["si", "슬로베니아"], ["sj", "스발바르 제도 및 얀마웬 섬[노르웨이]"], ["sk", "슬로바키아"], ["sl", "시에라리온"], ["sm", "산마리노"], ["sn", "세네갈"], ["so", "소말리아"], ["sr", "수리남"], ["ss", "남수단"], ["st", "상투메 프린시페"], ["su", "구 소련"], ["sv", "엘살바도르"], ["sy", "시리아"], ["sx", "신트마르턴"], ["sz", "에스와티니"], 
               ["tc", "터크스 케이커스 제도"], ["td", "차드"], ["tf", "프랑스령 남방 및 남극 지역"], ["tg", "토고"], ["th", "태국"], ["tj", "타지키스탄"], ["tk", "토켈라우"], ["tl", "동티모르"], ["tm", "투르크메니스탄"], ["tn", "튀니지"], ["to", "통가"], ["tr", "튀르키예"], ["tt", "트리니다드 토바고"], ["tv", "투발루"], ["tw", "대만"], ["tz", "탄자니아"], 
               ["ua", "우크라이나"], ["ug", "우간다"], ["uk", "영국"], ["um", "미국령 군소 제도"], ["us", "미국"], ["uy", "우루과이"], ["uz", "우즈베키스탄"], 
               ["va", "바티칸 시국"], ["vc", "세인트 빈센트 그레나딘"], ["ve", "베네수엘라"], ["vg", "영국령 버진아일랜드"], ["vi", "미국령 버진아일랜드"], ["vn", "베트남"], ["vu", "바누아투"], 
               ["wf", "왈리스 퓌튀나"], ["ws", "사모아"], 
               ["ye", "예멘"], ["yt", "마요트"], ["yu", "유고슬라비아/세르비아 몬테네그로"], 
               ["za", "남아프리카 공화국"], ["zm", "잠비아"], ["zr", "자이르"], ["zw", "짐바브웨"]]

const ColorsKeywards = ["black", "silver", "gray", "white", "maroon", "red", "purple", "fuchsia", "green", "lime", "olive", "yellow", "navy", "blue", "teal", "aqua", "orange", "aquamarine", "azure", "beige", "bisque", "blanchedalmond", "brown", "burlywood", "chartreuse", "chocolate", "coral", "cornsilk", "crimson", "cyan", "firebrick", "gainsboro", "gold", "grey", "honeydew", "indigo", "ivory", "khaki", "lavender", "lavenderblush", "lemonchiffon", "linen", "magenta", "mint", "mistyrose", "moccasin", "oldlace", "orchid", "paleturquoise", "papayawhip", "peachpuff", "peru", "pink", "plum", "salmon", "seashell", "sienna", "snow", "tan", "thistle", "tomato", "turquoise", "violet", "wheat"];
const ElementOne = ['H', 'B', 'C', 'N', 'O', 'F', 'P', 'S', 'K', 'V', 'Y', 'I', 'W', 'U'];
const ElementTwo = ['He', 'Li', 'Be', 'Ne', 'Na', 'Mg', 'Al', 'Si', 'Cl', 'Ar', 'Ca', 'Sc', 'Ti', 'Cr', 'Mn', 'Fe', 'Co', 'Ni', 'Cu', 'Zn', 'Ga', 'Ge', 'As', 'Se', 'Br', 'Kr', 'Rb', 'Sr', 'Zr', 'Nb', 'Mo', 'Tc', 'Ru', 'Rh', 'Pd', 'Ag', 'Cd', 'In', 'Sn', 'Sb', 'Te', 'Xe', 'Cs', 'Ba', 'La', 'Ce', 'Pr', 'Nd', 'Pm', 'Sm', 'Eu', 'Gd', 'Tb', 'Dy', 'Ho', 'Er', 'Tm', 'Yb', 'Lu', 'Hf', 'Ta', 'Re', 'Os', 'Ir', 'Pt', 'Au', 'Hg', 'Tl', 'Pb', 'Bi', 'Po', 'At', 'Rn', 'Fr', 'Ra', 'Ac', 'Th', 'Pa', 'Np', 'Pu', 'Am', 'Cm', 'Bk', 'Cf', 'Es', 'Fm', 'Md', 'No', 'Lr', 'Rf', 'Db', 'Sg', 'Bh', 'Hs', 'Mt', 'Ds', 'Rg', 'Cn', 'Nh', 'Fl', 'Mc', 'Lv', 'Ts', 'Og'];

// rules.js

const SYMBOLS = /[`~!@#$%^&*|\\;:\/?_.]/g;

rules = [
  {
    check(password) {
      return !password.includes(password);
    },
    get text() {
      return "비밀번호엔 비밀번호의 길이가 들어가야합니다.";
    }
  },
  {
    check(password) {
      return !isNaN(Number(password[password.length - 1]));
    },
    get text() {
      return "비밀번호엔 마지막에 숫자가 올 수 없습니다.";
    }
  },
  {
    check(password) {
      return Boolean(password.at(-1)?.match(SYMBOLS));
    },
    get text() {
      return "비밀번호엔 마지막에 특수기호가 올 수 없습니다.";
    }
  },
  {
    check(password) {
      return Boolean(password.at(0)?.match(SYMBOLS));
    },
    get text() {
      return "비밀번호엔 처음에 특수기호가 올 수 없습니다.";
    }
  },
  {
    check(password) {
      for (let c of ColorsKeywards) {
        if (password.match(RegExp(c, 'gi'))) {
          return false;
        }
      }
      return true;
    },
    get text() {
      return "비밀번호엔 색 이름 중 하나 이상이 들어가야합니다.";
    },
    detail: ColorsKeywards.join(' | ')
  },
  {
    check(password) {
      for (let c of ['zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine']) {
        if (password.match(RegExp(c, 'gi'))) {
          return false;
        }
      }
      return true;
    },
    get text() {
      return "비밀번호엔 숫자(0~9)를 나타내는 영어 중 하나가 들어가야합니다.";
    },
    detail: ['zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine'].join(' | ')
  },
  {
    check(password) {
      return password.includes(new Date().getMinutes());
    },
    get text() {
      return "비밀번호엔 현재 시간의 분이 포함되어야 합니다.";
    },
    get detail() {
      let d = new Date();
      return `현재는 ${d.getHours}시 ${d.getMinutes}분 입니다.`
    }
  },
  {
    check(password) {
      let sum = 0;
      for (let c of password) {
        if (!isNaN(c)) {
          sum += Number(c);
        }
      }
      if (sum > 48) return true;
      else return false;
    },
    get text() {
      return "비밀번호엔 각 자리 숫자의 합이 48을 넘어선 안됩니다.";
    }
  },
  {
    check(password) {
      let sum = 0;
      for (let c of password) {
        if (!isNaN(c)) {
          sum += Number(c);
        }
      }
      if (sum < 16) return true;
      else return false;
    },
    get text() {
      return "비밀번호엔 각 자리 숫자의 합이 16보다 작으면 안됩니다.";
    }
  },
  {
    check(password) {
      return !(password.match(/[2-9]/)) && password.match(/[0-2]/);
    },
    get text() {
      return "비밀번호엔 숫자가 이진법으로만 구성될 수 없습니다.";
    }
  },
  {
    check(password) {
      for (let c of ['do', 're', 'mi', 'fa', 'sol', 'ra', 'si']) {
        if (password.match(RegExp(c, 'gi'))) {
          tmp = password.match(RegExp(c, 'gi'));
          return true;
        }
      }
      return false;
    },
    tmp: null,
    get text() {
      return "비밀번호엔 음계의 이름이 들어갈 수 없습니다: "+tmp[0];
    }
  },
  {
    check(password) {
      return password.length > 1 && password.at(0) != password.at(-1);
    },
    get text() {
      return "비밀번호는 수미상관 구조를 띄고 있어야 합니다.";
    }
  },
  {
    check(password) {
      if (password.match(/[a-zA-Z]/)) {
        return password.match(/[a-zA-Z]/)[0]?.charCodeAt() >= 97;
      } else return false;
    },
    get text() {
      return "비밀번호의 첫 영문자는 대문자가 와야 합니다.";
    }
  },
  {
    check(password) {
      return Boolean(password.match(/[A-Z][A-Z][A-Z]/));
    },
    get text() {
      return "비밀번호에 대문자가 세 번 연속 올 수 없습니다.";
    }
  },
  {
    check(password) {
      let lastNum = Number(password.match(/(?!0-9)\d+(\.\d+)?(?!0-9)/g)?.at(-1));
      if (lastNum) {
        for (let i of password.match(/(?!0-9)\d+(\.\d+)?(?!0-9)/g)) {
          if (lastNum < Number(i)) {
            return true;
          }
        }
      }
      return false;
    },
    get text() {
      return "비밀번호에 마지막 숫자는 앞의 숫자들보다 크거나 같아야 합니다.";
    }
  },
  {
    check(password) {
      let firstNum = Number(password.match(/(?!0-9)\d+(\.\d+)?(?!0-9)/g)?.at(0));
      if (firstNum) {
        for (let i of password.match(/(?!0-9)\d+(\.\d+)?(?!0-9)/g)) {
          if (firstNum > Number(i)) {
            return true;
          }
        }
      }
      return false;
    },
    get text() {
      return "비밀번호에 첫 숫자는 뒤의 숫자들보다 작거나 같아야 합니다.";
    }
  },
  {
    check(password) {
      let nums = password.match(/[0-9]/g);
      if (nums) {
        if (password.length / 2 <= nums.length) {
          return true;
        }
      }
      return false;
    },
    get text() {
      return "비밀번호에 숫자가 50% 이상을 차지하면 안됩니다.";
    }
  },
  {
    check(password) {
      for (let c of ['fk', 'sht', 'wtf', 'sbl']) {
        if (password.match(RegExp(c.split('').join('.*'), 'gi'))) {
          tmp = c;
          return true
        }
      }
      return false;
    },
    tmp: null,
    get text() {
      return "비밀번호에 욕설을 연상시키는 문자들이 들어갈 수 없습니다. 순서를 바꾸거나 제외시켜주세요: "+tmp.split('').join('~');
    }
  },
  {
    check(password) {
      return Boolean(password.match(/([.`~!@#$%^&*|\\;:\/?_])\1/));
    },
    get text() {
      return "비밀번호에 같은 특수기호가 두 번 연속으로 반복될 수 없습니다.";
    }
  },
  {
    check(password) {
      return Boolean(password.match(/([.`~!@#$%^&*|\\;:\/?_]).*\1.*\1/));
    },
    get text() {
      return "비밀번호에 같은 특수기호가 세 번 이상 쓰일 수 없습니다.";
    }
  },
  {
    check(password) {
      let kb = ['qwertyuiop', 'asdfghjkl', 'zxcvbnm'];
      for (let chars of kb) {
        for (let i = 0; i < chars.length - 2; i++) {
          if (password.match(RegExp(chars[i]+chars[i+1]+chars[i+2], 'i'))) {
            return true;
          }
        }
      }
      return false;
    },
    get text() {
      return "비밀번호엔 키보드에 연속으로 있는 영문자는 세 글자 이상 연속으로 사용할 수 없습니다.";
    }
  },
  {
    check(password) {
      return !(password.includes('I') || password.includes('V') || password.includes('X'));
    },
    get text() {
      return "비밀번호엔 로마식 숫자(I~X)가 대문자로 하나 이상 들어가야 합니다.";
    }
  },
  {
    check(password) {
      for (let c of ccTLD) {
        if (password.includes(c[0])) {
          tmp = [c[0], c[1]];
          return true;
        }
      }
      return false;
    },
    tmp: null,
    get text() {
      return "비밀번호엔 국가를 의미하는 도메인(ccTLD)이 소문자로 포함될 수 없습니다: "+tmp[0]+' ('+tmp[1]+')';
    }
  },
  {
    check(password) {
      for (let c of ccTLD) {
        if (password.includes(c[0].toUpperCase())) {
          tmp = [c[0].toUpperCase(), c[1]];
          return true;
        }
      }
      return false;
    },
    tmp: null,
    get text() {
      return "비밀번호엔 국가를 의미하는 도메인(ccTLD)이 대문자로 포함될 수 없습니다: "+tmp[0]+' ('+tmp[1]+')';
    },
    detail: ccTLD.map(a => a[0]).join(' | '),
  },
  {
    check(password) {
      return password.match(/[a-z]/g)?.length >= password.length / 2;
    },
    get text() {
      return "비밀번호에 소문자가 50% 이상을 차지하면 안됩니다.";
    }
  },
  {
    check(password) {
      return password.match(/[A-Z]/g)?.length >= password.length / 3;
    },
    get text() {
      return "비밀번호에 대문자가 33% 이상을 차지하면 안됩니다.";
    }
  },
  {
    check(password) {
      return password.match(SYMBOLS)?.length >= password.length / 3;
    },
    get text() {
      return "비밀번호에 특수기호가 33% 이상을 차지하면 안됩니다.";
    }
  },
  {
    check(password) {
      return password.match(/[a-zA-Z]/g)?.length <= password.match(/[0-9]/g)?.length;
    },
    get text() {
      return "비밀번호엔 영어가 숫자보다 많아야 합니다.";
    }
  },
  {
    check(password) {
      return !password.match(/.+@.+\..+/g);
    },
    get text() {
      return "비밀번호는 이메일 형식으로 작성되어야 합니다.";
    },
    detail: "XXX@XXX.XXX: 도메인은 자유입니다.",
  },
  {
    check(password) {
      password = password.toUpperCase();
      let firstAscii = password.match(/[A-Z]/g)?.at(0).charCodeAt();

      if (firstAscii) {
        for (let c of password.match(/[A-Z]/g)) {
          if (firstAscii > c.charCodeAt()) {
            return true;
          }
        }
      }
      return false;
    },
    get text() {
      return "비밀번호의 맨 앞의 영문자는 뒤에 나오는 영문자들보다 빠르거나 같은 순서여야 합니다.";
    },
    detail: "대소문자는 구분하지 않습니다.",
  },
  {
    check(password) {
      let nums = password.match(/[0-9]+/g)?.map(Number);

      if (nums) {
        for (let i of nums) {
          for (let i = 2; i < nums; i++) {
            if (i >= nums / 2) return false;
            if (nums % i == 0) break;
          }
        }
      }
    },
    get text() {
      return "비밀번호에 소수(prime)가 포함되어야 합니다.";
    },
    detail: "중간에 '.'이 있는 경우엔 '.' 기준 왼쪽 오른쪽이 다른 정수로 인식됩니다.",
  },
  {
    check(password) {
      let nums = password.match(/[0-9]+/g)?.map(Number);

      if (nums) {
        for (let i of nums) {
          if (i % 2 == 0) return false;
        }
      }

      return true;
    },
    get text() {
      return "비밀번호에 짝수가 포함되어야 합니다.";
    },
    detail: "중간에 '.'이 있는 경우엔 '.' 기준 왼쪽 오른쪽이 다른 정수로 인식됩니다.",
  },
  {
    check(password) {
      let nums = password.match(/[0-9]+/g)?.map(Number);

      if (nums) {
        for (let i of nums) {
          if (i % 2 == 1) return false;
        }
      }

      return true;
    },
    get text() {
      return "비밀번호에 홀수가 포함되어야 합니다.";
    },
    detail: "중간에 '.'이 있는 경우엔 '.' 기준 왼쪽 오른쪽이 다른 정수로 인식됩니다.",
  },
  {
    check(password) {
      return !(password.match(/(?!0-9)\d+\.\d+(?!0-9)/g));
    },
    get text() {
      return "비밀번호에 소수(demical)가 포함되어야 합니다.";
    },
    detail: "소수의 뒤에 또 다른 '.' 이 있어도 소수로 인정됩니다.",
  },
  {
    check(password) {
      for (let c of ElementOne) {
        if (password.includes(c)) return false;
      }
      return true;
    },
    get text() {
      return "비밀번호에 한 글자 원소 기호가 들어가야 합니다.";
    },
    detail: ElementOne.join(' | '),
  },
  {
    check(password) {
      for (let c of ElementTwo) {
        if (password.includes(c)) return true;
      }
      return false;
    },
    get text() {
      return "비밀번호에 두 글자 원소 기호가 들어가면 안됩니다.";
    },
    detail: "'대문자+소문자(Aa)'의 조합으로 들어가야 합니다. \n"+ElementTwo.join(' | '),
  },
  {
    check(password) {
      let nums = password.match(/(?!0-9)\d+(\.\d+)?(?!0-9)/g);
      for (let i in nums) {
        for (let j = i + 1; j < nums.length; j++) {
          if (nums[i] == nums[j]) return true;
        }
      }
      return false;
    },
    get text() {
      return "비밀번호에 모든 숫자는 다 달라야합니다.";
    },
  },
  {
    check(password) {
      if (password.includes('V') || password.includes('v')) {
        return 1001;
      } else {
        return true;
      }
    },
    get text() {
      return "로봇이 아닙니다";
    },
    detail: "아니라면 'V' 혹은 'v'를 입력해주세요"
  },
  {
    check(password) {
      let nums = password.match(/(?!0-9)\d+(\.\d+)?(?!0-9)/g);
      if (nums) {
        for (let i = 0; i < nums.length - 1; i++) {
          if (nums[i] <= nums[i+1]) return false;
        }
      }
      return true;
    },
    get text() {
      return "비밀번호의 숫자가 내림차순으로 정렬되면 안됩니다.";
    },
    detail: "수가 겹치는 건 상관없습니다.",
  },
  {
    check(password) {
      let nums = password.match(/(?!0-9)\d+(\.\d+)?(?!0-9)/g);
      if (nums) {
        for (let i = 0; i < nums.length - 1; i++) {
          if (nums[i] >= nums[i+1]) return false;
        }
      }
      return true;
    },
    get text() {
      return "비밀번호의 숫자가 오름차순으로 정렬되면 안됩니다.";
    },
    detail: "수가 겹치는 건 상관없습니다.",
  },
  {
    check(password) {
      if (password.match(/[Il|][Il|]/)) {
        tmp = password.match(/[Il|][Il|]/)[0];
        return true;
      }
      if (password.match(/[O0][O0]/)) {
        tmp = password.match(/[O0][O0]/)[0];
        return true;
      }
      return false;
    },
    get text() {
      return "비밀번호에 비슷하게 보이는 문자는 붙어 있을 수 없습니다: "+tmp;
    },
    detail: "(I, l, 1, |) (0, O)",
  },
]